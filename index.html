<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cricket Game</title>
    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <h1>Cricket Game</h1>
    <button
      class="choice-btn"
      onclick="
      computerChoice = generateComputerChoice()
      result = generateResult('Bat', computerChoice)
      showResult('Bat', computerChoice, generateResult)
      "
    >
      <img src="./images/Bat.png" alt="Bat-Image" class="choice-image" />
    </button>

    <button
      class="choice-btn"
      onclick="
      computerChoice = generateComputerChoice()
      result = generateResult('Ball', computerChoice)
      showResult('Ball', computerChoice, generateResult)
      "
    >
      <img src="./images/Ball.png" alt="Ball-Image" class="choice-image" />
    </button>

    <button
      class="choice-btn"
      onclick="
      computerChoice = generateComputerChoice()
      result = generateResult('Stump', computerChoice)
      showResult('Stump', computerChoice, generateResult)
      "
    >
      <img src="./images/Stump.png" alt="Stump-Image" class="choice-image" />
    </button>

    <h3 class="user-move"></h3>
    <h3 class="computer-move"></h3>
    <h3 class="result"></h3>
    <h3 class="score"></h3>

    <button
      onclick="localStorage.clear() 
      resetScore();"
    >
      Reset
    </button>

    <script>
      let scoreStr = localStorage.getItem("Score");
      let score;
      resetScore(scoreStr);

      function resetScore(scoreStr) {
        score = scoreStr
          ? JSON.parse(scoreStr)
          : {
              win: 0,
              lost: 0,
              tie: 0,
            };

        score.showResult = function () {
          return `Win: ${score.win}
        Lost: ${score.lost}
        Tie: ${score.tie}`;
        };

        showResult();
      }

      function generateComputerChoice() {
        randomNo = Math.random() * 3;
        if (randomNo > 0 && randomNo <= 1) {
          return "Bat";
        } else if (randomNo > 1 && randomNo <= 2) {
          return "Ball";
        } else {
          return "Stump";
        }
      }

      function generateResult(userChoice, computerChoice) {
        if (userChoice === "Bat") {
          if (computerChoice === "Bat") {
            score.tie++;
            return `Its a Tie`;
          } else if (computerChoice === "Ball") {
            score.win++;
            return `You won`;
          } else if (computerChoice === "Stump") {
            score.lost++;
            return `Computer won`;
          }
        } else if (userChoice === "Ball") {
          if (computerChoice === "Bat") {
            score.win++;
            return `You won`;
          } else if (computerChoice === "Ball") {
            score.tie++;
            return `It's a Tie`;
          } else if (computerChoice === "Stump") {
            score.lost++;
            return `Computer won`;
          }
        } else {
          if (computerChoice === "Bat") {
            score.win++;
            return `You won`;
          } else if (computerChoice === "Ball") {
            score.lost++;
            return `Computer won`;
          } else if (computerChoice === "Stump") {
            score.tie++;
            return `It's a Tie`;
          }
        }
      }

      function showResult(userChoice, computerChoice, generateResult) {
        localStorage.setItem("Score", JSON.stringify(score));
        document.querySelector(".user-move").innerText = userChoice
          ? `You have chosen ${userChoice}`
          : "";
        document.querySelector(".computer-move").innerText = computerChoice
          ? `Computer choice is ${computerChoice}`
          : "";
        document.querySelector(".result").innerText = generateResult
          ? `${result}`
          : "";
        document.querySelector(".score").innerText = `${score.showResult()}`;
      }
    </script>
  </body>
</html>
